var nmgr=window.nmgr||{};jQuery(function(e){nmgr.selectors={modal:"#nmgr-modal"},nmgr.block=function(t){nmgr.is_blocked(t)||e(t).addClass("is-blocked").block({message:null,overlayCSS:{backgroundColor:"#fff"},css:{backgroundColor:"transparent",border:"none"}})},nmgr.unblock=function(t){e(t).removeClass("is-blocked").unblock()},nmgr.is_blocked=function(t){return e(t).is("is-blocked")||e(t).parents("is-blocked").length},nmgr.scroll_to=function(t){e(t).length&&(nmgr.is_in_modal(t)?e("#nmgr-modal").animate({scrollTop:0}):e("html, body").animate({scrollTop:e(t).offset().top-100},1e3))},nmgr.go_to=function(t){-1===t.indexOf("https://")||-1===t.indexOf("http://")?window.location=t:window.location=decodeURI(t)},nmgr.show_notice=function(t,n){$target=e(".woocommerce-notices-wrapper:first")||e(".nmgr-cart-item-add-to-cart").closest(".woocommerce"),!0===n&&nmgr.is_in_modal()&&($target=e(nmgr.selectors.modal).find(".modal-body")),$target.length&&(nmgr.remove_notice(),e(t).addClass("nmgr-notice").prependTo($target),nmgr.scroll_to($target))},nmgr.remove_notice=function(t){var n=".woocommerce-error, .woocommerce-message, .woocommerce-info";(void 0!==t?e(t).find(n):e(n)).remove()},nmgr.refresh_cart_fragments=function(){e.post(nmgr_global_params.ajax_url,{action:"nmgr_get_cart_fragments"},function(t){t&&t.fragments&&e(document.body).trigger("added_to_cart",[t.fragments,t.cart_hash])})},nmgr.make_table_responsive=function(t,n){n=n||600;t=e(t=t||".nmgr-table");t.width()>n?t.addClass("responsive"):t.removeClass("responsive")},nmgr.tiptip=function(){e(".nmgr-tip").each(function(){var t=e(this),n={},i=t.find("title");t.attr("data-tiptip-position")&&(n.defaultPosition=t.attr("data-tiptip-position")),t.is("svg")&&(n.content=function(){if(i.length&&i.attr("data-title"))return i.text(""),i.attr("data-title")}),t.tipTip(n)})},nmgr.tiptip(),nmgr.modal={},document.querySelector(nmgr.selectors.modal)&&(nmgr.modal=new BSN.Modal(nmgr.selectors.modal)),nmgr.modal.data={},nmgr.is_in_modal=function(t){return t?e(nmgr.selectors.modal).hasClass("show")&&0<e(t).closest(nmgr.selectors.modal).length:e(nmgr.selectors.modal).hasClass("show")},nmgr.modal.has_content=function(t){return 0<e(nmgr.selectors.modal).find(t).length},nmgr.modal.show_or_update=function(){nmgr.is_in_modal()?(e(nmgr.selectors.modal).first().trigger("update.bs.modal"),nmgr.modal.update()):(e(nmgr.selectors.modal).first().trigger("show.bs.modal"),nmgr.modal.show())},nmgr.modal.set_content=function(t){nmgr.modal.setContent(t),e(nmgr.selectors.modal).first().trigger("set_content.bs.modal")},nmgr.init_datepicker=function(i){i=i||"#nmgr_event_date";var a="nmgr-datepicker",t={dateFormat:nmgr_global_params.date_format};nmgr_global_params.style_datepicker&&(t=Object.assign(t,{beforeShow:function(t,n){n.id===i.replace(/^#/,"")&&n.dpDiv.addClass(a)},onClose:function(t,n){n.id===i.replace(/^#/,"")&&n.dpDiv.removeClass(a)}})),e(i).datepicker(t)},nmgr.stupidtable=function(t){e(t).stupidtable(),e(t).on("aftertablesort",this.add_arrow),e(t).find("th").on("mouseenter",this.show_default_arrow),e(t).find("th").on("mouseleave",this.remove_default_arrow)},nmgr.stupidtable.prototype.add_arrow=function(t,n){var i=e(this).find("th"),a="asc"===n.direction?"&uarr;":"&darr;",n=n.column;i.find(".nmgr-arrow").remove(),i.eq(n).append('<span class="nmgr-arrow">'+a+"</span>")},nmgr.stupidtable.prototype.show_default_arrow=function(){e(this).hasClass("sortable")&&0===e(this).find(".nmgr-arrow").length&&e(this).append('<span class="nmgr-arrow hover">&uarr;</span>')},nmgr.stupidtable.prototype.remove_default_arrow=function(){e(this).find(".nmgr-arrow.hover").remove()},e(document.body).on("nmgr_added_to_cart nmgr_removed_from_wishlist",nmgr.refresh_cart_fragments)}),jQuery(function(e){if("undefined"==typeof nmgr_frontend_params)return!1;function t(t){this.container=e(t),this.tabSelectedClass="nmgr-tab-selected",this.tabHoverClass="nmgr-tab-hover",this.tabSelector=this.container.find(".nmgr-tab"),this.anchorSelector=this.tabSelector.find(" > a"),this.tabContentSelector=this.container.find(".nmgr-tab-content"),this.tabContentVisibleClass="nmgr-visible",this.container.length&&(this.showDefaultContent(),this.tabSelector.on("mouseenter",{nmgrTab:this},this.onTabMouseEnter),this.tabSelector.on("mouseleave",{nmgrTab:this},this.onTabMouseLeave),this.anchorSelector.on("click",{nmgrTab:this},this.onAnchorClick),e(window).on("hashchange",{nmgrTab:this},this.onHashChange))}t.prototype.showDefaultContent=function(){this.getHash()?this.showContent(this.getHash()):this.showContent(e(this.tabSelector).first())},t.prototype.onHashChange=function(t){var n=t.data.nmgrTab.getHash();t.data.nmgrTab.showContent(n),nmgr.scroll_to(n)},t.prototype.getHash=function(){var t=window.location.hash;return 0<=t.toLowerCase().indexOf("nmgr-")&&t},t.prototype.onTabMouseEnter=function(t){e(this).addClass(t.data.nmgrTab.tabHoverClass)},t.prototype.onTabMouseLeave=function(t){e(this).removeClass(t.data.nmgrTab.tabHoverClass)},t.prototype.onAnchorClick=function(t){t.preventDefault(),t.data.nmgrTab.showContent(e(this).parent())},t.prototype.showContent=function(t){"undefined"!==e(t)&&e(t).is(this.tabSelector)&&e(t).length||(t=e(this.tabSelector).first());var n=e(t).find("a").attr("href");e(this.tabSelector).removeClass(this.tabSelectedClass),e(this.tabContentSelector).removeClass(this.tabContentVisibleClass).hide(),e(t).addClass(this.tabSelectedClass),this.container.find(n).addClass(this.tabContentVisibleClass).show(),e(document.body).trigger("nmgr_tab_shown",[t])},nmgr.account_tabs=new t("#nmgr-account-tabs"),e(nmgr.selectors.modal).on("set_content.bs.modal",function(){nmgr.account_tabs=new t("#nmgr-account-tabs")}),e(".nmgr-go-to-tab").on("click",function(t){var n=e(this).attr("href");0<=n.toLowerCase().indexOf("#nmgr-tab")&&(t.preventDefault(),nmgr.scroll_to(n),nmgr.account_tabs.showContent(n))}),nmgr.mago={container:"#nmgr-mago",template:!1,self:"",el:"",identifier:"",data:{},init:function(){this.el=document.querySelector(this.container),this.el&&(this.template||(this.template=this.el.cloneNode(!0)),this.self=new BSN.Modal(this.container),e(document.body).on("click","[data-dialog-content]",this.showForDataAttr),this.el.addEventListener("hidden.bs.modal",this.reset,!1))},showForDataAttr:function(t){var n=t.currentTarget.dataset.dialogContent.replace("#",""),i=document.getElementById(n);i&&(nmgr.mago.setContent(i.innerHTML,n),nmgr.mago.setup(t.target),nmgr.mago.show(),t.preventDefault())},setup:function(t){t=t instanceof Element?t.dataset:t;t.dialogWidth&&"small"===t.dialogWidth&&this.el.querySelector(".modal-dialog").classList.remove("modal-lg"),t.dialogTitle&&this.setTitle(t.dialogTitle),t.dialogBody&&this.setBody(t.dialogBody),t.dialogClass&&"string"==typeof t.dialogClass&&this.el.classList.add(t.dialogClass)},update:function(){e(this.container).first().trigger("update.bs.modal"),this.self.update()},show:function(){e(this.container).first().trigger("show.bs.modal"),this.self.show()},hide:function(){this.self.hide()},showOrUpdate:function(){this.hasContent()?this.update():this.show()},setContent:function(t,n){this.self.setContent(t),"string"==typeof n&&(this.el.classList.add(n),this.identifier=n),e(this.container).first().trigger("set_content.bs.modal")},setTitle:function(t){this.el.querySelector(".modal-title").innerHTML=t},setBody:function(t){this.el.querySelector(".modal-body").innerHTML=t},reset:function(){this.classList.value=nmgr.mago.template.classList.value,this.innerHTML=nmgr.mago.template.innerHTML},hasContent:function(t){return t?this.el.classList.contains("show")&&null!==this.el.querySelector(t):this.el.classList.contains("show")}},nmgr.mago.init(),jQuery(function(o){var r=".nmgr-add-to-wishlist-wrapper",s=".nmgr-add-to-wishlist-form",d=".nmgr-add-to-wishlist-button",i=".nmgr-dialog-submit-button",m=".nmgr-add-to-wishlist-content",l={init:function(){o(document.body).on("click",d,this.prepare_to_add).on("click",i,this.dialog_submit_btn_clicked).on("nmgr_removed_from_wishlist",this.removed_from_wishlist).on("nmgr_wishlist_created nmgr_profile_reloaded nmgr_shipping_reloaded",this.set_add_to_wishlist_wishlist_id).on("nmgr_profile_reloaded  nmgr_shipping_reloaded",this.enable_dialog_submit_btn)},removed_from_wishlist:function(t,n){o(r).find(".nmgr-view-wishlist-button").remove(),n&&n.items_data&&n.items_data.forEach(function(t){var n=o(".nmgr-add-to-wishlist-form-"+t.product_id);0<n.length&&(t.product_in_wishlist||n.removeClass("product-in-wishlist"))})},show_notice:function(t,n){$target=o(".woocommerce-notices-wrapper:first")||o(".nmgr-add-to-wishlist-button").closest(".woocommerce"),$target.length?($target.prepend(t),o("html, body").animate({scrollTop:$target.offset().top-100},1e3)):n.closest(r).after(t)},prepare_to_add:function(t){t.preventDefault();var n=o(this),i=n.parent(s),a=i.find("input[name=nmgr_wid]");i.is(".redirect")?i.submit():(o(r).find(".nmgr-view-wishlist-button").remove(),n.is(".disabled")?n.is(".wc-variation-is-unavailable")?alert(nmgr_frontend_params.i18n_unavailable_text):n.is(".wc-variation-selection-needed")&&alert(nmgr_frontend_params.i18n_make_a_selection_text):(nmgr.modal.data.formdata=i.serializeArray(),o(nmgr.modal.data.formdata).each(function(t,n){nmgr.modal.data[n.name]=n.value}),"auto"===i.attr("data-create_wishlist")?l.auto_create_wishlist(o(this)):"modal"===i.attr("data-create_wishlist")?l.dialog_create_new_wishlist(t):a.val()&&1===parseInt(a.attr("data-shipping-address-required"))?l.dialog_set_shipping_address(a.val()):i.is(".product-type-grouped")?l.dialog_add_to_wishlist():l.ajax_action(o(this))))},auto_create_wishlist:function(n){var i={action:"nmgr_auto_create_wishlist",_wpnonce:nmgr_frontend_params.nonce,get_add_to_wishlist_dialog:!0,nmgr_global:JSON.stringify(nmgr_global_params.global)};o(nmgr.modal.data.formdata).each(function(t,n){i[n.name]=n.value}),o.post(nmgr_global_params.ajax_url,i,function(t){t.data.wishlist&&(o(s).attr("data-create_wishlist",""),$wishlist_input=o("input[name=nmgr_wid"),$wishlist_input.val(t.data.wishlist.id),nmgr_frontend_params.shipping_address_required&&!t.data.wishlist.has_shipping_address?$wishlist_input.attr("data-shipping-address-required",1):$wishlist_input.attr("data-shipping-address-required",0),n.trigger("click"))})},dialog_create_new_wishlist:function(t){t.preventDefault();t=JSON.parse(JSON.stringify(nmgr_global_params.global));t.is_modal=!0;t={action:"nmgr_dialog_create_new_wishlist",context:"add_to_wishlist",_wpnonce:nmgr_frontend_params.nonce,nmgr_global:JSON.stringify(t)};o.post(nmgr_global_params.ajax_url,t,function(t){t.data.template&&(nmgr.modal.set_content(t.data.template),nmgr.modal.show_or_update(),nmgr.modal.data.action="create_new_wishlist")})},dialog_add_to_wishlist:function(){var t=JSON.parse(JSON.stringify(nmgr_global_params.global));t.is_modal=!0;var i={action:"nmgr_dialog_add_to_wishlist",_wpnonce:nmgr_frontend_params.nonce,nmgr_global:JSON.stringify(t)};void 0!==nmgr.modal.data.formdata&&o(nmgr.modal.data.formdata).each(function(t,n){i[n.name]=n.value}),void 0!==nmgr.modal.data.nmgr_wid&&(i.nmgr_wid=nmgr.modal.data.nmgr_wid),o.post(nmgr_global_params.ajax_url,i,function(t){t.data.template&&(nmgr.modal.data.action="add_to_wishlist",nmgr.modal.set_content(t.data.template),nmgr.modal.show_or_update())})},set_add_to_wishlist_wishlist_id:function(t,n){var i=o('input[name="nmgr_wid');"create_new_wishlist"===nmgr.modal.data.action&&(nmgr.modal.data.nmgr_wid=n.id,o(s).attr("data-create_wishlist",""),i.val(n.id));-1!==o.inArray(nmgr.modal.data.action,["set_shipping_address","create_new_wishlist"])&&(nmgr_frontend_params.shipping_address_required&&!n.has_shipping_address?i.attr("data-shipping-address-required",1):i.attr("data-shipping-address-required",0))},ajax_action:function(i){var t,a=i.parent(s);t=nmgr.is_in_modal()&&"add_to_wishlist"===nmgr.modal.data.action?(nmgr.modal.hide(),o(nmgr.selectors.modal).find("form").serializeArray()):a.serializeArray(),i.removeClass("added"),i.addClass("loading"),a.find(".nmgr-animate").removeClass("nmgr-animation-scaleshrink");var e={action:"nmgr_add_to_wishlist",_wpnonce:nmgr_frontend_params.nonce};o(t).each(function(t,n){e[n.name]=n.value}),o(document.body).trigger("nmgr_adding_to_wishlist",[i,a,e]),o.post(nmgr_global_params.ajax_url,e,function(t){var n;o(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),i.removeClass("loading"),t&&(t.error?l.show_notice(t.notice,a):(t.success&&(a.addClass("product-in-wishlist"),a.find(".nmgr-animate").addClass("nmgr-animation-scaleshrink"),a.is(".single")&&l.show_notice(t.notice,a),t.notice&&o(t.notice).find(".wc-forward").length&&a.is(".archive")&&!a.parent(r).find(".nmgr-view-wishlist-button").length&&(n=o(".wc-forward",o(t.notice)).removeClass("button").addClass("nmgr-view-wishlist-button")[0].outerHTML,a.after(n))),o(document.body).trigger("nmgr_added_to_wishlist",[t,i,a])))})},dialog_set_shipping_address:function(t){var n=JSON.parse(JSON.stringify(nmgr_global_params.global));n.is_modal=!0;n={action:"nmgr_dialog_set_shipping_address",_wpnonce:nmgr_frontend_params.nonce,nmgr_wid:t,context:"add_to_wishlist",nmgr_global:JSON.stringify(n)};o.post(nmgr_global_params.ajax_url,n,function(t){nmgr.modal.set_content(t.data.template),nmgr.modal.show_or_update(),nmgr.modal.data.action="set_shipping_address"})},dialog_submit_btn_clicked:function(t){t.preventDefault();var n=o(this),i=o(m);if(actions=["set_shipping_address","create_new_wishlist"],-1!==o.inArray(nmgr.modal.data.action,actions)&&n.is(".disabled")&&n.attr("data-message"))alert(n.attr("data-message"));else if(!n.is(".disabled")){if(-1!==o.inArray(nmgr.modal.data.action,actions)&&nmgr.modal.data.nmgr_pid)return o(".nmgr-add-to-wishlist-form-"+nmgr.modal.data.nmgr_pid).find(d).trigger("click"),void nmgr.modal.hide();if(n.attr("data-action")&&"add_to_wishlist"===n.attr("data-action")&&"add_to_wishlist"===nmgr.modal.data.action){o("select[name=nmgr_wid]");if(i.hasClass("product-type-grouped")){var a=i.find("input.qty");if(a.length){for(var e=!1,r=0;r<a.length;r++)0<o(a[r]).val()&&(e=!0);if(!e)return void alert([nmgr_frontend_params.i18n_select_quantity_text])}else if(i.find('input[name*=nmgr_qty]:not(".qty")').length&&!i.find('input[name*=nmgr_qty]:not(".qty"):checked').length)return void alert([nmgr_frontend_params.i18n_select_product_text])}t=o(".nmgr-add-to-wishlist-form-"+nmgr.modal.data.nmgr_pid),n=t.find(d);t.is('.nmgr-ajax-add-to-wishlist:not(".redirect, .disabled")')&&n.is(':not(".disabled")')?l.ajax_action(n,t):i.submit()}}},enable_dialog_submit_btn:function(t,n){(nmgr.is_in_modal()&&"create_new_wishlist"===nmgr.modal.data.action&&!nmgr_frontend_params.shipping_address_required||nmgr_frontend_params.shipping_address_required&&n.has_shipping_address)&&o(nmgr.selectors.modal).find(i).attr("disabled",!1)}},g={init:function(){o(".variations_form").on("found_variation.wc-variation-form",this.found_variation).on("show_variation",this.show_variation).on("hide_variation",this.hide_variation)},get_wishlist_form:function(t){var n=o(t).data("product_id");return o(t).closest(".product").find("[data-nmgr_product_id="+n+"]")},found_variation:function(t,n){var i=o(this).serialize(),a=g.get_wishlist_form(this);a.find('input[name="nmgr_vid"]').val(n.variation_id).change(),a.find('input[name="nmgr_wc_form_values"]').val(i).change(),a.find("input.qty").attr("min",n.min_qty).attr("max",n.max_qty)},show_variation:function(t,n,i){var a=g.get_wishlist_form(this),e=a.find(d);i?(a.removeClass("disabled"),e.removeClass("disabled wc-variation-selection-needed")):(a.addClass("disabled"),e.removeClass("wc-variation-selection-needed").addClass("disabled wc-variation-is-unavailable"))},hide_variation:function(){var t=g.get_wishlist_form(this);t.addClass("disabled"),t.find(d).addClass("disabled wc-variation-selection-needed")}};l.init(),g.init()}),jQuery(function(e){var n=".nmgr-cart";({init:function(){e(document.body).on("nmgr_added_to_wishlist nmgr_items_reloaded",this.reload).on("click",".nmgr-cart-item-remove",this.remove_wishlist_item).on("click",".nmgr-cart-item-add-to-cart",this.add_to_wc_cart).on("click",".nmgr-show-cart-contents",this.dialog_show_cart_contents)},reload:function(){var a=e(n).length;0<a&&e(n).each(function(n){var i=e(this);nmgr.block(i);var t={action:"nmgr_load_wishlist_cart",data:i.data(),_wpnonce:nmgr_frontend_params.nonce,nmgr_global:JSON.stringify(nmgr_global_params.global)};e.post(nmgr_global_params.ajax_url,t,function(t){i.replaceWith(t.data.template),nmgr.unblock(i),a-1===n&&(nmgr.is_in_modal()&&nmgr.remove_notice(nmgr.selectors.modal),e(document.body).trigger("nmgr_cart_reloaded"))})})},dialog_show_cart_contents:function(t){e(this).is(".redirect")||(t.preventDefault(),t={action:"nmgr_load_wishlist_cart",data:e(this).closest(n).data(),_wpnonce:nmgr_frontend_params.nonce,context:"dialog",nmgr_global:JSON.stringify(nmgr_global_params.global)},e.post(nmgr_global_params.ajax_url,t,function(t){t.data.template&&(nmgr.modal.set_content(t.data.template),nmgr.modal.show())}))},remove_wishlist_item:function(t){t.preventDefault(),window.confirm(e(this).attr("data-notice"))&&nmgr.items.delete_items([e(this).data("wishlist-item-id")],e(this).data("wishlist-id"))},add_to_wc_cart:function(t){t.preventDefault();var i={};e.each(e(this).data(),function(t,n){i[t.replace(/([a-zA-Z])(?=[A-Z])/g,"$1-").toLowerCase()]=n}),nmgr.items.add_to_cart([i])}}).init()});var n,r={container:"#nmgr-overview",wishlist:{},do_reload:!1,init:function(){e(document.body).on("click",".nmgr-share-wishlist .nmgr-copy",this.copy_link).on("nmgr_items_reloaded nmgr_profile_reloaded nmgr_shipping_reloaded",this.reload)},copy_link:function(t){t.preventDefault();t=e("<input>");e("body").append(t),t.val(e(".nmgr-share-wishlist .link").text()).select(),document.execCommand("copy"),e(".nmgr-share-wishlist .nmgr-copy").text(nmgr_frontend_params.i18n_copied_text),t.remove()},reload:function(t,n){var i=parseInt(e(r.container).attr("data-wishlist-id")),a=void 0!==n&&n.id?n.id:i;r.do_reload||0!==i&&void 0!==n&&n.id&&i!==parseInt(n.id)||(r.do_reload=!0,a={action:"nmgr_load_overview",nmgr_global:JSON.stringify(nmgr_global_params.global),wishlist_id:parseInt(a),_wpnonce:e(r.container).attr("data-nonce")},nmgr.block(r.container),e.post(nmgr_global_params.ajax_url,a,function(t){e(r.container).replaceWith(t),r.wishlist=n,r.reloaded()}))},reloaded:function(){setTimeout(function(){r.do_reload=!1},500),nmgr.tiptip(),e(document.body).trigger("nmgr_overview_reloaded",this.wishlist)}};r.init(),nmgr.profile={container:"#nmgr-profile",noticeTimer:"",wishlist:{},init:function(){nmgr.init_datepicker(),e(nmgr.selectors.modal).on("set_content.bs.modal",nmgr.profile.dialog_init),e(document.body).on("submit",".nmgr-profile-form",this.submit).on("nmgr_profile_reloaded",this.update_tab_title)},dialog_init:function(){nmgr.modal.has_content(nmgr.profile.container)&&nmgr.init_datepicker()},reload:function(t,n){var i=parseInt(e(nmgr.profile.container).attr("data-wishlist-id")),a=void 0!==n&&n.id?n.id:i;0!==i&&void 0!==n&&n.id&&i!==parseInt(n.id)||(a={action:"nmgr_load_profile",wishlist_id:parseInt(a),nmgr_global:JSON.stringify(nmgr_global_params.global),_wpnonce:e(nmgr.profile.container).attr("data-nonce")},nmgr.block(nmgr.profile.container),e.post(nmgr_global_params.ajax_url,a,function(t){e(nmgr.profile.container).replaceWith(t),nmgr.profile.wishlist=n,nmgr.profile.reloaded(t)}))},reloaded:function(t){nmgr.init_datepicker(),e(document.body).trigger("nmgr_profile_reloaded",[this.wishlist,t])},showNotice:function(t){e(t).addClass("nmgr-notice").prependTo(e(nmgr.profile.container)),clearTimeout(this.noticeTimer),this.noticeTimer=setTimeout(function(){e("#nmgr-profile .nmgr-notice").fadeOut(400,function(){e(this).remove()})},7e3)},submit:function(t){t.preventDefault();var n=e(this),t={data:n.serialize(),action:"nmgr_save_profile",wishlist_id:e(nmgr.profile.container).attr("data-wishlist-id"),_wpnonce:e(nmgr.profile.container).attr("data-nonce"),nmgr_global:JSON.stringify(nmgr_global_params.global)};return nmgr.block(n),e.post(nmgr_global_params.ajax_url,t,function(t){t.success&&t.data&&(t.data.wishlist&&(nmgr.profile.wishlist=t.data.wishlist),t.data.redirect?nmgr.go_to(t.data.redirect):(t.data.html&&e(nmgr.profile.container).replaceWith(e(t.data.html)),t.data.created&&e(document.body).trigger("nmgr_wishlist_created",[nmgr.profile.wishlist,t]),nmgr.profile.reloaded(t))),t.data&&t.data.notice&&(nmgr.profile.showNotice(t.data.notice),nmgr.scroll_to(e('#nmgr-profile [role="alert"]'))),nmgr.unblock(n)}),!1},update_tab_title:function(t,n){0===n.id||(n=e("#nmgr-tab-profile").find(".nmgr-icon")).length&&"require-profile"===n.attr("data-notice")&&!n.hasClass("nmgr-hide")&&n.addClass("nmgr-hide")}},nmgr.profile.init(),nmgr.items={container:"#nmgr-items",wishlist:{},init:function(){new nmgr.stupidtable(".nmgr-items-table"),nmgr.make_table_responsive(".nmgr-items-table"),this.checkValidation(),e(window).on("resize",function(){nmgr.make_table_responsive(".nmgr-items-table")}),e(document.body).on("change","#nmgr-items td.quantity input.quantity",this.quantity_changed).on("click","#nmgr-items a.edit-wishlist-item",this.edit_item).on("click","#nmgr-items a.delete-wishlist-item",this.pre_delete_item).on("click","#nmgr-items button.save-action",this.save_items).on("click","#nmgr-items .nmgr-add-items-action",this.add_items_action).on("change",".nmgr-product-search",this.new_add_items_row).on("click",".nmgr-add-items-dialog .nmgr-add",this.add_items).on("nmgr_wishlist_created nmgr_shipping_reloaded",this.reload).on("removed_from_cart",nmgr.remove_notice).on("click",".nmgr_add_to_cart_button",this.add_single_product_to_cart).on("nmgr_added_to_cart nmgr_removed_from_wishlist",nmgr.refresh_cart_fragments).on("nmgr_tab_shown",this.maybe_make_table_responsive).on("nmgr_add_to_cart_response",this.remove_loading_animation),nmgr.mago.el.addEventListener("show.bs.modal",this.init_add_items_form,!1)},reload:function(t,n){var i=parseInt(e(nmgr.items.container).attr("data-wishlist-id")),a=void 0!==n&&n.id?n.id:i;0!==i&&void 0!==n&&n.id&&i!==parseInt(n.id)||(a={action:"nmgr_load_items",wishlist_id:parseInt(a),nmgr_global:JSON.stringify(nmgr_global_params.global),_wpnonce:e(nmgr.items.container).attr("data-nonce")},nmgr.block(nmgr.items.container),e.post(nmgr_global_params.ajax_url,a,function(t){e(nmgr.items.container).replaceWith(t),nmgr.items.wishlist=n,nmgr.items.reloaded()}))},reloaded:function(){e(document.body).trigger("nmgr_items_reloaded",this.wishlist),new nmgr.stupidtable(".nmgr-items-table"),this.checkValidation(),nmgr.make_table_responsive(".nmgr-items-table")},checkValidation:function(){e("#nmgr-items input").on("invalid",function(){e(this).closest("tr").find(".edit").show(),e(this).closest("tr").find(".view").hide(),e("#nmgr-items button.save-action").attr("data-reload",!0)})},quantity_changed:function(){var t=e(this).closest("tr.item"),n=e(this).val(),i=e("input.item_total",t),t=e(".cost",t).attr("data-sort-value");i.val(t*n)},edit_item:function(){return e(this).closest("tr").find(".view").toggle(),e(this).closest("tr").find(".edit").toggle(),e("#nmgr-items button.save-action").attr("data-reload",!0),!1},pre_delete_item:function(t){var n;t.preventDefault(),window.confirm(e(this).attr("data-notice"))&&(n=[e(this).closest("tr.item").attr("data-wishlist_item_id")],t=e(nmgr.items.container).attr("data-wishlist-id"),nmgr.items.delete_items(n,t))},delete_items:function(t,n){nmgr.block(nmgr.items.container);n={wishlist_item_ids:t,action:"nmgr_delete_items",wishlist_id:n,_wpnonce:nmgr_global_params.nonce,nmgr_global:JSON.stringify(nmgr_global_params.global)};return"true"===e("#nmgr-items button.save-action").attr("data-reload")&&(n.items=e(".nmgr-items-table :input[name]").serialize()),e.post(nmgr_global_params.ajax_url,n,function(t){t.success?(nmgr.items.wishlist=t.wishlist,e(nmgr.items.container).replaceWith(e(t.template)),nmgr.items.reloaded(),e(document.body).trigger("nmgr_removed_from_wishlist",t)):t.error&&t.notice&&window.alert(t.notice)}),!1},save_items:function(){var t={items:e(".nmgr-items-table :input[name]").serialize(),action:"nmgr_save_items",wishlist_id:e(nmgr.items.container).attr("data-wishlist-id"),_wpnonce:e(nmgr.items.container).attr("data-nonce"),nmgr_global:JSON.stringify(nmgr_global_params.global)};return nmgr.block(nmgr.items.container),e.post(nmgr_global_params.ajax_url,t,function(t){t.success&&(nmgr.items.wishlist=t.data.wishlist,e(nmgr.items.container).replaceWith(e(t.data.html)),nmgr.items.reloaded()),nmgr.unblock(nmgr.items.container)}),!1},add_items_action:function(){e(this).attr("data-url")&&nmgr.go_to(e(this).attr("data-url"))},init_add_items_form:function(){var t="nmgr-add-items-dialog";this.classList.contains(t)&&(nmgr.items.reset_add_items_form("."+t),e(document.body).trigger("nmgr-select2-init"))},reset_add_items_form:function(t){void 0!==t&&(e(t).find("tr.added-row").remove(),e(t).find("form").trigger("reset").find(":input").each(function(){e(this).is(".nmgr-product-search")&&e(this).val("")}))},new_add_items_row:function(){var t,n;e(this).closest("tr").is(":last-child")&&(n=(t=e(this).closest("table").find("tbody")).find("tr").length,n=t.data("row").replace(/\[0\]/g,"["+n+"]"),t.append('<tr class="added-row">'+n+"</tr>"),e(document.body).trigger("nmgr-select2-init"))},add_items:function(){var t=e(this).closest(".nmgr-add-items-dialog").find("table tbody").find("tr"),a=[];e(t).each(function(){var t=e(this).find(':input[name="item_id"]').val(),n=e(this).find(':input[name="item_qty"]').val(),i=e(this).find(':input[name="item_fav"]').val();a.push({id:t,qty:n||1,fav:i})}),nmgr.mago.self.hide(),nmgr.block(nmgr.items.container);t={action:"nmgr_add_item",wishlist_id:e(nmgr.items.container).attr("data-wishlist-id"),nmgr_global:JSON.stringify(nmgr_global_params.global),data:a};"true"===e("#nmgr-items button.save-action").attr("data-reload")&&(t.items=e(".nmgr-items-table :input[name]").serialize()),e.ajax({type:"POST",url:nmgr_global_params.ajax_url,data:t,dataType:"json",success:function(t){t.success?(e(nmgr.items.container).replaceWith(t.data.html),nmgr.items.reloaded()):(nmgr.unblock(nmgr.items.container),window.alert(t.data.error))}})},add_single_product_to_cart:function(t){var n=e(this),i={},a=n.closest(".nmgr-add-to-cart-form");if(!n.is(".nmgr_ajax_add_to_cart"))return!0;t.preventDefault(),e(a.serializeArray()).each(function(t,n){i[n.name]=n.value}),n.removeClass("added").addClass("loading"),nmgr.items.add_to_cart([i])},add_to_cart:function(t){t={action:"nmgr_add_to_cart",nmgr_items:t,nmgr_global:JSON.stringify(nmgr_global_params.global)};e.post(nmgr_global_params.ajax_url,t,function(t){t.success&&t.redirect_url?window.location=t.redirect_url:(e(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),e(document.body).trigger("nmgr_add_to_cart_response",t),t.notice&&nmgr.show_notice(t.notice,!0),t.success&&e(document.body).trigger("nmgr_added_to_cart",[t.items_data||""]))})},remove_loading_animation:function(t,n){void 0!==n&&n.items_data&&e(nmgr.items.container)&&n.items_data.forEach(function(t){e(nmgr.items.container).find('tr[data-wishlist_item_id="'+t.wishlist_item_id+'"] .nmgr_add_to_cart_button').removeClass("loading")})},maybe_make_table_responsive:function(t,n){e(n).is("#nmgr-tab-items")&&nmgr.make_table_responsive(".nmgr-items-table")}},nmgr.items.init(),nmgr.shipping={container:"#nmgr-shipping",noticeTimer:"",wishlist:{},init:function(){this.ship_to_account_address(),this.init_country_state_select2(),e(nmgr.selectors.modal).on("set_content.bs.modal",this.dialog_init),e(document.body).on("nmgr_wishlist_created",this.reload).on("change","#nmgr_ship_to_account_address",this.ship_to_account_address).on("submit",".nmgr-shipping-form",this.submit).on("nmgr_shipping_reloaded",this.update_tab_title)},reload:function(t,n){var i=parseInt(e(nmgr.shipping.container).attr("data-wishlist-id")),a=void 0!==n&&n.id?n.id:i;0!==i&&void 0!==n&&n.id&&i!==parseInt(n.id)||(a={action:"nmgr_load_shipping",wishlist_id:parseInt(a),nmgr_global:JSON.stringify(nmgr_global_params.global),_wpnonce:e(nmgr.shipping.container).attr("data-nonce")},nmgr.block(nmgr.shipping.container),e.post(nmgr_global_params.ajax_url,a,function(t){e(nmgr.shipping.container).replaceWith(t),nmgr.shipping.wishlist=n,nmgr.shipping.reloaded()}))},reloaded:function(){e(document.body).trigger("nmgr_shipping_reloaded",this.wishlist),this.ship_to_account_address(),this.init_country_state_select2()},init_country_state_select2:function(){e(document.body).trigger("country_to_state_changed"),e(nmgr.shipping.container).find("#shipping_country").trigger("refresh")},ship_to_account_address:function(){var t=e(nmgr.shipping.container),n=t.find("#nmgr_ship_to_account_address");n.is(":checked")?n.closest("label").attr("data-save")?window.confirm(nmgr_frontend_params.i18n_use_account_shipping_address_text)?e(".nmgr-shipping-form").submit():n.prop("checked",!1):(t.find(".account-shipping-address").slideDown(),t.find(".wishlist-shipping-address").hide()):(t.find(".account-shipping-address").slideUp(),t.find(".wishlist-shipping-address").slideDown())},dialog_init:function(){nmgr.modal.has_content("#nmgr-shipping")&&(nmgr.shipping.ship_to_account_address(),e(document.body).off("country_to_state_changed"))},showNotice:function(t){e(t).addClass("nmgr-notice").prependTo(e(nmgr.shipping.container)),clearTimeout(this.noticeTimer),this.noticeTimer=setTimeout(function(){e("#nmgr-shipping .nmgr-notice").fadeOut(400,function(){e(this).remove()})},7e3)},submit:function(t){t.preventDefault();var n=e(this),t={data:n.serialize(),action:"nmgr_save_shipping",wishlist_id:e(nmgr.shipping.container).attr("data-wishlist-id"),_wpnonce:e(nmgr.shipping.container).attr("data-nonce"),nmgr_global:JSON.stringify(nmgr_global_params.global)};return nmgr.block(n),e.ajax({url:nmgr_global_params.ajax_url,data:t,type:"POST",dataType:"json",success:function(t){e(nmgr.shipping.container).find("#nmgr_ship_to_account_address").closest("label").attr("data-save",1),t.data.wishlist&&(nmgr.shipping.wishlist=t.data.wishlist),t.success&&t.data.html&&e(nmgr.shipping.container).replaceWith(e(t.data.html)),t.data.notice&&(nmgr.shipping.showNotice(t.data.notice),nmgr.scroll_to(e('#nmgr-shipping [role="alert"]'))),nmgr.shipping.reloaded(),nmgr.unblock(n)}}),!1},update_tab_title:function(t,n){var i;nmgr_frontend_params.shipping_address_required&&0<e(".nmgr-tabs").length&&((i=e("#nmgr-tab-shipping").find(".nmgr-icon")).length&&"require-shipping-address"===i.attr("data-notice")&&(n.has_shipping_address&&!i.hasClass("nmgr-hide")?i.addClass("nmgr-hide"):n.has_shipping_address||i.removeClass("nmgr-hide")))}},nmgr.shipping.init(),(n=document.querySelector('input[name="nmgr_enable_wishlist"]'))&&n.addEventListener("change",function(){n.checked||window.confirm(nmgr_frontend_params.disable_notice)?document.getElementById("nmgr-enable-wishlist-form").submit():n.checked=!0},!1)});